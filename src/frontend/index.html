<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUCO Production System - 生產管理系統</title>
    <link rel="stylesheet" href="rwd-fixes.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f9fafb;
            --sidebar-width: 260px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Microsoft JhengHei', sans-serif;
            background: #f3f4f6;
            color: #1f2937;
        }

        /* 側邊欄 */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 30px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-menu {
            padding: 20px 0;
        }

        .nav-item {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: white;
        }

        .nav-icon {
            display: inline-block;
            width: 20px;
            margin-right: 10px;
        }

        /* 主要內容區 */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* 頂部導航 */
        .topbar {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .page-title {
            font-size: 24px;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* 內容區 */
        .content {
            padding: 30px;
        }

        /* 統計卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* 圖表區域 */
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
        }

        /* 工作站狀態 */
        .workstation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .workstation-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e5e7eb;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .workstation-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .workstation-id {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .workstation-name {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 15px;
        }

        .workstation-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-idle {
            background: #fed7aa;
            color: #92400e;
        }

        .status-maintenance {
            background: #fee2e2;
            color: #991b1b;
        }

        /* 工單列表 */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f9fafb;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
        }

        tr:hover {
            background: #f9fafb;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* 按鈕 */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* 頁面切換 */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* 響應式 */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 載入動畫 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 即時數據指示器 */
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: #fef3c7;
            border-radius: 20px;
            font-size: 12px;
            color: #92400e;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: #f59e0b;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
    </style>
</head>
<body>
    <!-- 側邊欄 -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span>🏭</span>
                <div>
                    <div>FUCO Production</div>
                    <div style="font-size: 12px; font-weight: normal; opacity: 0.9;">生產管理系統</div>
                </div>
            </div>
        </div>
        <nav class="nav-menu">
            <a class="nav-item active" onclick="showPage('dashboard')">
                <span class="nav-icon">📊</span> 主儀表板
            </a>
            <a class="nav-item" href="dashboard-live.html">
                <span class="nav-icon">�</span> 即時監控看板
            </a>
            <a class="nav-item" href="production-record.html">
                <span class="nav-icon">📋</span> 生產記錄
            </a>
            <a class="nav-item" href="reports.html">
                <span class="nav-icon">📈</span> 報表中心
            </a>
            <a class="nav-item" href="workstation.html">
                <span class="nav-icon">🖥️</span> 工作站管理
            </a>
            <a class="nav-item" href="sop.html?id=SOP-A-001">
                <span class="nav-icon">📖</span> SOP程序
            </a>
            <a class="nav-item" href="equipment.html?id=A">
                <span class="nav-icon">⚙️</span> 設備管理
            </a>
            <a class="nav-item" href="production-planning-dashboard.html">
                <span class="nav-icon">🏭</span> 生產規劃
            </a>
            <a class="nav-item" onclick="showPage('settings')">
                <span class="nav-icon">⚙️</span> 系統設定
            </a>
        </nav>
    </div>

    <!-- 主要內容 -->
    <div class="main-content">
        <!-- 頂部導航 -->
        <div class="topbar">
            <div style="display: flex; align-items: center; gap: 20px;">
                <button class="mobile-menu-toggle" onclick="toggleSidebar()">☰</button>
                <h1 class="page-title" id="pageTitle">儀表板</h1>
            </div>
            <div class="user-info">
                <div class="live-indicator">
                    <span class="live-dot"></span>
                    <span>即時數據</span>
                </div>
                <div class="user-avatar">管</div>
                <div>
                    <div style="font-weight: 600;">系統管理員</div>
                    <div style="font-size: 12px; color: #6b7280;">admin</div>
                </div>
            </div>
        </div>

        <!-- 內容區 -->
        <div class="content">
            <!-- 儀表板頁面 -->
            <div id="dashboard" class="page active">
                <!-- 統計卡片 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">今日生產量</div>
                        <div class="stat-value" style="color: var(--primary);">1,650</div>
                        <div class="stat-change positive">
                            <span>↑</span>
                            <span>12.5% 較昨日</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">良品率</div>
                        <div class="stat-value" style="color: var(--success);">96.97%</div>
                        <div class="stat-change positive">
                            <span>↑</span>
                            <span>2.3% 改善</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">設備稼動率</div>
                        <div class="stat-value" style="color: var(--warning);">92.5%</div>
                        <div class="stat-change negative">
                            <span>↓</span>
                            <span>1.2% 下降</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">待處理工單</div>
                        <div class="stat-value" style="color: var(--secondary);">8</div>
                        <div class="stat-change positive">
                            <span>↓</span>
                            <span>3 單完成</span>
                        </div>
                    </div>
                </div>

                <!-- 生產趨勢圖表 -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">生產趨勢 - 本週</h2>
                        <a href="reports.html" class="btn btn-primary">詳細報表</a>
                    </div>
                    <canvas id="productionChart" width="400" height="100"></canvas>
                </div>

                <!-- 快速訪問功能 -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">快速訪問</h2>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card" style="cursor: pointer;" onclick="window.location.href='production-record.html'">
                            <div class="stat-label">📋 生產記錄</div>
                            <div style="font-size: 16px; color: var(--primary); margin-top: 10px;">
                                提交生產數據、品質檢查
                            </div>
                            <div class="stat-change positive" style="margin-top: 15px;">
                                <span>點擊進入</span>
                            </div>
                        </div>
                        <div class="stat-card" style="cursor: pointer;" onclick="window.location.href='reports.html'">
                            <div class="stat-label">📈 報表中心</div>
                            <div style="font-size: 16px; color: var(--secondary); margin-top: 10px;">
                                生產統計、趨勢分析
                            </div>
                            <div class="stat-change positive" style="margin-top: 15px;">
                                <span>點擊進入</span>
                            </div>
                        </div>
                        <div class="stat-card" style="cursor: pointer;" onclick="window.location.href='dashboard-live.html'">
                            <div class="stat-label">📺 即時監控</div>
                            <div style="font-size: 16px; color: var(--success); margin-top: 10px;">
                                即時數據、設備狀態
                            </div>
                            <div class="stat-change positive" style="margin-top: 15px;">
                                <span>點擊進入</span>
                            </div>
                        </div>
                        <div class="stat-card" style="cursor: pointer;" onclick="window.location.href='workstation.html'">
                            <div class="stat-label">🖥️ 工作站管理</div>
                            <div style="font-size: 16px; color: var(--warning); margin-top: 10px;">
                                工作站配置、狀態管理
                            </div>
                            <div class="stat-change positive" style="margin-top: 15px;">
                                <span>點擊進入</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 工作站即時狀態 -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">工作站即時狀態</h2>
                        <a href="workstation.html" class="btn btn-primary">管理工作站</a>
                    </div>
                    <div class="workstation-grid" id="workstationGrid">
                        <!-- 動態載入 -->
                    </div>
                </div>
            </div>

            <!-- 工作站管理頁面 -->
            <div id="workstations" class="page">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2 class="chart-title">工作站列表</h2>
                        <button class="btn btn-primary">新增工作站</button>
                    </div>
                    <div class="workstation-grid" id="workstationList">
                        <!-- 動態載入 -->
                    </div>
                </div>
            </div>

            <!-- 工單管理頁面 -->
            <div id="workorders" class="page">
                <div class="table-container">
                    <div style="padding: 20px; border-bottom: 1px solid #e5e7eb;">
                        <div class="chart-header">
                            <h2 class="chart-title">工單列表</h2>
                            <button class="btn btn-primary">新增工單</button>
                        </div>
                    </div>
                    <table id="workOrderTable">
                        <thead>
                            <tr>
                                <th>工單編號</th>
                                <th>產品代碼</th>
                                <th>數量</th>
                                <th>進度</th>
                                <th>狀態</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="workOrderBody">
                            <!-- 動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 其他頁面 -->
            <div id="production" class="page">
                <div class="chart-container">
                    <h2 class="chart-title">生產執行</h2>
                    <p style="margin-top: 20px; color: #6b7280;">生產執行功能開發中...</p>
                </div>
            </div>

            <div id="quality" class="page">
                <div class="chart-container">
                    <h2 class="chart-title">品質管理</h2>
                    <p style="margin-top: 20px; color: #6b7280;">品質管理功能開發中...</p>
                </div>
            </div>

            <div id="reports" class="page">
                <div class="chart-container">
                    <h2 class="chart-title">報表分析</h2>
                    <p style="margin-top: 20px; color: #6b7280;">報表分析功能開發中...</p>
                </div>
            </div>

            <div id="settings" class="page">
                <div class="chart-container">
                    <h2 class="chart-title">系統設定</h2>
                    
                    <!-- 基本設定 -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--dark); font-size: 16px; margin-bottom: 20px;">基本設定</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">系統名稱</label>
                                <input type="text" value="FUCO Production System" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">公司名稱</label>
                                <input type="text" value="福桑聯合企業" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">系統版本</label>
                                <input type="text" value="v1.0.0" disabled style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; background: #e5e7eb;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 生產設定 -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--dark); font-size: 16px; margin-bottom: 20px;">生產設定</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">預設工作時間</label>
                                <select style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                                    <option value="8">8小時制</option>
                                    <option value="12" selected>12小時制</option>
                                    <option value="24">24小時制</option>
                                </select>
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">品質標準</label>
                                <input type="number" value="95" min="0" max="100" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                                <small style="color: #6b7280;">合格率標準 (%)</small>
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <label style="display: block; font-weight: 600; margin-bottom: 10px;">生產目標</label>
                                <input type="number" value="2000" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                                <small style="color: #6b7280;">每日生產目標</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 通知設定 -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--dark); font-size: 16px; margin-bottom: 20px;">通知設定</h3>
                        <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <label style="font-weight: 600;">設備故障警報</label>
                                <input type="checkbox" checked style="transform: scale(1.2);">
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <label style="font-weight: 600;">品質異常通知</label>
                                <input type="checkbox" checked style="transform: scale(1.2);">
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <label style="font-weight: 600;">生產目標達成提醒</label>
                                <input type="checkbox" style="transform: scale(1.2);">
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                <label style="font-weight: 600;">維護排程提醒</label>
                                <input type="checkbox" checked style="transform: scale(1.2);">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 用戶管理 -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--dark); font-size: 16px; margin-bottom: 20px;">用戶管理</h3>
                        <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <span style="font-weight: 600;">目前用戶：4 位</span>
                                <button class="btn btn-primary" style="padding: 8px 16px; font-size: 12px;">管理用戶</button>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e5e7eb;">
                                    <div style="font-weight: 600; margin-bottom: 5px;">admin</div>
                                    <div style="font-size: 12px; color: #6b7280;">系統管理員</div>
                                    <div style="font-size: 12px; color: var(--success); margin-top: 5px;">在線</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e5e7eb;">
                                    <div style="font-weight: 600; margin-bottom: 5px;">emp001</div>
                                    <div style="font-size: 12px; color: #6b7280;">操作員</div>
                                    <div style="font-size: 12px; color: #6b7280; margin-top: 5px;">離線</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e5e7eb;">
                                    <div style="font-weight: 600; margin-bottom: 5px;">supervisor</div>
                                    <div style="font-size: 12px; color: #6b7280;">主管</div>
                                    <div style="font-size: 12px; color: #6b7280; margin-top: 5px;">離線</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e5e7eb;">
                                    <div style="font-weight: 600; margin-bottom: 5px;">qc001</div>
                                    <div style="font-size: 12px; color: #6b7280;">品管</div>
                                    <div style="font-size: 12px; color: #6b7280; margin-top: 5px;">離線</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 系統資訊 -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--dark); font-size: 16px; margin-bottom: 20px;">系統資訊</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <div style="font-weight: 600; margin-bottom: 10px;">資料庫狀態</div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 8px; height: 8px; background: var(--success); border-radius: 50%;"></div>
                                    <span style="color: var(--success);">正常連線</span>
                                </div>
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <div style="font-weight: 600; margin-bottom: 10px;">API 狀態</div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 8px; height: 8px; background: var(--success); border-radius: 50%;"></div>
                                    <span style="color: var(--success);">服務正常</span>
                                </div>
                            </div>
                            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                                <div style="font-weight: 600; margin-bottom: 10px;">系統運行時間</div>
                                <div style="color: var(--text);">12 小時 34 分鐘</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 操作按鈕 -->
                    <div style="margin-top: 40px; display: flex; gap: 15px; justify-content: center;">
                        <button class="btn btn-primary" onclick="saveSettings()">保存設定</button>
                        <button class="btn" style="background: #f3f4f6; color: var(--text);" onclick="resetSettings()">重置設定</button>
                        <button class="btn" style="background: var(--warning); color: white;" onclick="exportSettings()">導出設定</button>
                        <button class="btn" style="background: var(--danger); color: white;" onclick="systemRestart()">重啟系統</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API 基礎 URL
        const API_BASE = 'http://localhost:8847/api';

        // 頁面切換
        function showPage(pageId) {
            // 隱藏所有頁面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 顯示選中的頁面
            document.getElementById(pageId).classList.add('active');
            
            // 更新導航選中狀態
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // 更新頁面標題
            const titles = {
                dashboard: '儀表板',
                workstations: '工作站管理',
                workorders: '工單管理',
                production: '生產執行',
                quality: '品質管理',
                reports: '報表分析',
                settings: '系統設定'
            };
            document.getElementById('pageTitle').textContent = titles[pageId];
            
            // 載入頁面數據
            loadPageData(pageId);
        }

        // 側邊欄切換
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // 載入頁面數據
        async function loadPageData(pageId) {
            switch(pageId) {
                case 'dashboard':
                    await loadWorkstations('workstationGrid');
                    drawProductionChart();
                    break;
                case 'workstations':
                    await loadWorkstations('workstationList');
                    break;
                case 'workorders':
                    await loadWorkOrders();
                    break;
            }
        }

        // 載入工作站數據
        async function loadWorkstations(containerId) {
            try {
                const response = await fetch(`${API_BASE}/workstations`);
                const data = await response.json();
                
                const container = document.getElementById(containerId);
                container.innerHTML = data.data.map(ws => `
                    <div class="workstation-card">
                        <div class="workstation-id">${ws.id}</div>
                        <div class="workstation-name">${ws.name}</div>
                        <div class="workstation-status status-${ws.status}">
                            ${ws.status === 'active' ? '運行中' : 
                              ws.status === 'idle' ? '閒置' : '維護中'}
                        </div>
                        ${ws.operator ? `<div style="margin-top: 10px; font-size: 12px; color: #6b7280;">操作員: ${ws.operator}</div>` : ''}
                    </div>
                `).join('');
            } catch (error) {
                console.error('載入工作站失敗:', error);
            }
        }

        // 載入工單數據
        async function loadWorkOrders() {
            try {
                const response = await fetch(`${API_BASE}/work-orders`);
                const data = await response.json();
                
                const tbody = document.getElementById('workOrderBody');
                tbody.innerHTML = data.data.map(order => `
                    <tr>
                        <td><strong>${order.orderNumber}</strong></td>
                        <td>${order.productCode}</td>
                        <td>${order.completedQuantity} / ${order.quantity}</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${order.progress}%"></div>
                            </div>
                            <div style="margin-top: 5px; font-size: 12px; color: #6b7280;">${order.progress}%</div>
                        </td>
                        <td>
                            <span class="workstation-status ${order.status === 'completed' ? 'status-active' : 'status-idle'}">
                                ${order.status === 'completed' ? '已完成' : '進行中'}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-primary" style="padding: 5px 15px; font-size: 12px;">查看</button>
                        </td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('載入工單失敗:', error);
            }
        }

        // 繪製生產趨勢圖表
        function drawProductionChart() {
            const canvas = document.getElementById('productionChart');
            const ctx = canvas.getContext('2d');
            
            // 簡單的條形圖
            const data = [850, 920, 1100, 1250, 1400, 1550, 1650];
            const labels = ['週一', '週二', '週三', '週四', '週五', '週六', '週日'];
            
            const width = canvas.width;
            const height = canvas.height;
            const barWidth = width / data.length * 0.6;
            const maxValue = Math.max(...data);
            
            ctx.clearRect(0, 0, width, height);
            
            data.forEach((value, index) => {
                const barHeight = (value / maxValue) * (height - 40);
                const x = (width / data.length) * index + (width / data.length - barWidth) / 2;
                const y = height - barHeight - 20;
                
                // 繪製條形
                const gradient = ctx.createLinearGradient(0, y, 0, height - 20);
                gradient.addColorStop(0, '#667eea');
                gradient.addColorStop(1, '#764ba2');
                ctx.fillStyle = gradient;
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // 繪製標籤
                ctx.fillStyle = '#6b7280';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(labels[index], x + barWidth / 2, height - 5);
                ctx.fillText(value, x + barWidth / 2, y - 5);
            });
        }

        // 定期更新數據
        setInterval(() => {
            const currentPage = document.querySelector('.page.active').id;
            if (currentPage === 'dashboard') {
                // 更新統計數據
                updateStats();
            }
        }, 5000);

        // 更新統計數據
        function updateStats() {
            // 模擬數據更新
            const productionValue = document.querySelector('.stat-value');
            if (productionValue) {
                const currentValue = parseInt(productionValue.textContent.replace(',', ''));
                const newValue = currentValue + Math.floor(Math.random() * 10);
                productionValue.textContent = newValue.toLocaleString();
            }
        }

        // 系統設定功能
        function saveSettings() {
            // 收集所有設定數據
            const settings = {
                systemName: document.querySelector('input[value="FUCO Production System"]').value,
                companyName: document.querySelector('input[value="福桑聯合企業"]').value,
                workHours: document.querySelector('select').value,
                qualityStandard: document.querySelector('input[value="95"]').value,
                productionTarget: document.querySelector('input[value="2000"]').value,
                notifications: {
                    equipmentFailure: document.querySelectorAll('input[type="checkbox"]')[0].checked,
                    qualityAlert: document.querySelectorAll('input[type="checkbox"]')[1].checked,
                    productionTarget: document.querySelectorAll('input[type="checkbox"]')[2].checked,
                    maintenanceSchedule: document.querySelectorAll('input[type="checkbox"]')[3].checked
                }
            };
            
            // 模擬保存到伺服器
            console.log('保存設定:', settings);
            alert('設定已保存成功！');
        }

        function resetSettings() {
            if (confirm('確定要重置所有設定到預設值嗎？')) {
                // 重置表單值
                document.querySelector('input[value*="FUCO"]').value = 'FUCO Production System';
                document.querySelector('input[value*="福桑"]').value = '福桑聯合企業';
                document.querySelector('select').value = '12';
                document.querySelector('input[value="95"]').value = '95';
                document.querySelector('input[value="2000"]').value = '2000';
                
                // 重置核取方塊
                document.querySelectorAll('input[type="checkbox"]')[0].checked = true;
                document.querySelectorAll('input[type="checkbox"]')[1].checked = true;
                document.querySelectorAll('input[type="checkbox"]')[2].checked = false;
                document.querySelectorAll('input[type="checkbox"]')[3].checked = true;
                
                alert('設定已重置為預設值！');
            }
        }

        function exportSettings() {
            const settings = {
                systemName: document.querySelector('input[value*="FUCO"]').value,
                companyName: document.querySelector('input[value*="福桑"]').value,
                workHours: document.querySelector('select').value,
                qualityStandard: document.querySelector('input[value="95"]').value,
                productionTarget: document.querySelector('input[value="2000"]').value,
                notifications: {
                    equipmentFailure: document.querySelectorAll('input[type="checkbox"]')[0].checked,
                    qualityAlert: document.querySelectorAll('input[type="checkbox"]')[1].checked,
                    productionTarget: document.querySelectorAll('input[type="checkbox"]')[2].checked,
                    maintenanceSchedule: document.querySelectorAll('input[type="checkbox"]')[3].checked
                },
                exportDate: new Date().toISOString()
            };
            
            // 創建下載連結
            const dataStr = JSON.stringify(settings, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `fuco_settings_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('設定檔案已導出！');
        }

        function systemRestart() {
            if (confirm('確定要重啟系統嗎？這將會中斷所有連線。')) {
                alert('系統重啟指令已發送，請稍候...');
                // 這裡可以調用實際的重啟API
                setTimeout(() => {
                    window.location.reload();
                }, 3000);
            }
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            loadPageData('dashboard');
        });
    </script>
</body>
</html>
